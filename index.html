<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Quiz B√≠blico Infantil ‚Äî IPUC Kids</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{
  --bg:#fdf6e3;
  --text:#333;
  --accent:#ff9f1c;
  --correct:#2ecc71;
  --wrong:#e74c3c;
  --card:#fff;
  --shadow:0 4px 12px rgba(0,0,0,.15);
  --radius:12px;
  --font:"Comic Sans MS",cursive,sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:var(--font)}
body{background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;padding:1rem}
h1,h2{margin:.5em 0}
button{cursor:pointer;border:none;border-radius:var(--radius);padding:.75em 1.5em;font-size:1.1rem;background:var(--accent);color:#fff;transition:transform .2s}
button:disabled{opacity:.5;cursor:not-allowed}
button:hover:not(:disabled){transform:translateY(-2px)}
.screen{display:none;width:100%;max-width:600px}
.screen.active{display:block}
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:1.5rem;text-align:center}
.bar{background:#ddd;height:10px;border-radius:5px;overflow:hidden;margin:.5em 0}
.bar div{background:var(--accent);height:100%;width:0;transition:width .3s}
.options{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin:1rem 0}
.options button{background:#fff;color:var(--text);border:2px solid var(--accent)}
.options button.correct{background:var(--correct);color:#fff;border-color:var(--correct)}
.options button.wrong{background:var(--wrong);color:#fff;border-color:var(--wrong)}
.emoji{width:64px;height:64px;margin:0 auto}
@keyframes confeti-fall{0%{transform:translateY(-100vh) rotate(0)}100%{transform:translateY(100vh) rotate(360deg)}}
.confeti{position:fixed;top:0;left:0;width:10px;height:10px;background:var(--accent);opacity:.8;animation:confeti-fall 2s linear}
.score{font-size:1.5rem;margin:.5em 0}
.msg{font-size:1.2rem;margin:.5em 0;min-height:1.5em}
.nav{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-top:1rem}
@media (prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}
</style>
</head>
<body>

<!-- ========== BIENVENIDA ========== -->
<section id="welcome" class="screen active">
  <div class="card">
    <svg class="emoji" viewBox="0 0 64 64" aria-label="Libro"><path fill="#ff9f1c" d="M56 8H8a4 4 0 00-4 4v40a4 4 0 004 4h48a4 4 0 004-4V12a4 4 0 00-4-4zM24 44h-4V20h4v24zm16 0h-4V20h4v24z"/></svg>
    <h1>Quiz B√≠blico Infantil</h1>
    <p>¬°Dios te ama y quiere que aprendas Sus historias!</p>
    <input id="playerName" placeholder="Escribe tu nombre" maxlength="12" style="width:100%;padding:.75em;margin:1em 0;border:2px solid var(--accent);border-radius:var(--radius)">
    <button id="startBtn">Comenzar üöÄ</button>
    <div class="nav">
      <button id="levelsBtnW">Ver niveles üèÜ</button>
      <button id="ipucBtnW">Regresar a IPUC Kids</button>
    </div>
  </div>
</section>

<!-- ========== NIVELES ========== -->
<section id="levels" class="screen">
  <div class="card">
    <h2>Mapa de niveles</h2>
    <div id="levelsGrid" style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin:1rem 0"></div>
    <div class="nav">
      <button id="backWelcome">‚Üê Inicio</button>
      <button id="ipucBtnL">Regresar a IPUC Kids</button>
    </div>
  </div>
</section>

<!-- ========== JUEGO ========== -->
<section id="game" class="screen">
  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center"><span id="levelTag">Nivel 1</span><span id="counter">Pregunta 1/10</span></div>
    <div class="bar"><div id="progressBar"></div></div>
    <h2 id="questionText"></h2>
    <div id="options" class="options"></div>
    <div class="score" id="score">Aciertos: 0</div>
    <div class="msg" id="motivMsg"></div>
    <div style="margin-top:1em;text-align:center">
      <button id="hintBtn" style="background:#3498db">Ayuda üí°</button>
      <button id="nextBtn" disabled>Siguiente ‚û°Ô∏è</button>
    </div>
    <p id="hintBox" style="margin-top:1em;display:none;font-size:.9em;background:#fef9e7;padding:.5em;border-radius:var(--radius)"></p>
  </div>
</section>

<!-- ========== RESULTADO ========== -->
<section id="result" class="screen">
  <div class="card">
    <h2>¬°Bien hecho <span id="resName"></span>!</h2>
    <p>Respondiste <strong id="resCorrect"></strong> de 10</p>
    <div id="stars"></div>
    <div class="nav">
      <button id="retryBtn">Repetir nivel üîÅ</button>
      <button id="levelsBtnR">Ver niveles üèÜ</button>
      <button id="ipucBtnR">Regresar a IPUC Kids</button>
    </div>
  </div>
</section>

<script>
/* ==========================================
   SONIDOS REALES (base64 ligero ~2-3 kB cada uno)
   ========================================== */
const sounds={
  click:new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAABJbmZvAAAAAwAAABwAAAACAAAAGgAAAPwAAAAAAPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+1DEQAAAAA8AAAAZTEzMjMyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/8AAAAgAAAAiAAAAPwAAAABAAAABAAAAAAAA"),
  ok:new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAABJbmZvAAAAAwAAABwAAAACAAAAGgAAAPwAAAAAAPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+1DEQAAAAA8AAAAZTEzMjMyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/8AAAAgAAAAiAAAAPwAAAABAAAABAAAAAAAA"),
  fail:new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAABJbmZvAAAAAwAAABwAAAACAAAAGgAAAPwAAAAAAPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+1DEQAAAAA8AAAAZTEzMjMyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/8AAAAgAAAAiAAAAPwAAAABAAAABAAAAAAAA"),
  win:new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAABJbmZvAAAAAwAAABwAAAACAAAAGgAAAPwAAAAAAPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+1DEQAAAAA8AAAAZTEzMjMyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/8AAAAgAAAAiAAAAPwAAAABAAAABAAAAAAAA")
};
function playSound(key){const s=sounds[key];s.currentTime=0;s.play().catch(()=>{});}

/* ==========================================
   MENSAJES MOTIVADORES
   ========================================== */
const goodMsgs=["¬°Excelente! Dios est√° feliz contigo üòä","¬°Muy bien! Sigue as√≠ üìñ","¬°Genial! Aprendes r√°pido üåü","¬°Bendito! Tu esfuerzo vale üí™"];
const badMsgs=["¬°√Ånimo! Todos aprendemos üíô","¬°No te rindas! Dios te ayuda üôè","¬°Int√©ntalo de nuevo! Puedes lograrlo ‚ú®","¬°Est√°s mejorando! Sigue adelante üòä"];

/* ==========================================
   NAVEGACI√ìN
   ========================================== */
const $=q=>document.querySelector(id=>id.charAt(0)==="#"?q:document.querySelector(q));
function show(id){document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));$(id).classList.add("active");}

/* ==========================================
   DATOS
   ========================================== */
const levels=[
  {
    level:1,title:"Nivel 1 ‚Äî Personajes Principiantes",
    questions:[
      {id:"1-01",q:"¬øQui√©n derrot√≥ a Goliat con una piedra y una honda?",opts:["David","Mois√©s","Abraham","El√≠as"],ans:0,hint:"Fue un joven pastor.",ref:"1 Samuel 17"},
      {id:"1-02",q:"¬øQui√©n construy√≥ el arca?",opts:["No√©","Abraham","Jon√°s","Jos√©"],ans:0,hint:"Antes del diluvio.",ref:"G√©nesis 6-9"},
      {id:"1-03",q:"¬øQui√©n recibi√≥ los Diez Mandamientos?",opts:["Mois√©s","Josu√©","Aar√≥n","Sans√≥n"],ans:0,hint:"Monte Sina√≠.",ref:"√âxodo 20"},
      {id:"1-04",q:"¬øQui√©n fue engullido por un gran pez?",opts:["Jon√°s","Daniel","Ezequiel","El√≠as"],ans:0,hint:"Tres d√≠as dentro.",ref:"Jon√°s 1-2"},
      {id:"1-05",q:"¬øQui√©n era el hermano de Abel?",opts:["Ca√≠n","Set","Enoc","Lamec"],ans:0,hint:"Primog√©nito.",ref:"G√©nesis 4"},
      {id:"1-06",q:"¬øQui√©n interpret√≥ sue√±os para el Fara√≥n?",opts:["Jos√©","Daniel","Mois√©s","Abraham"],ans:0,hint:"T√∫nica de colores.",ref:"G√©nesis 41"},
      {id:"1-07",q:"¬øEsposa de Isaac?",opts:["Rebeca","Sara","Raquel","Lea"],ans:0,hint:"Junto al pozo.",ref:"G√©nesis 24"},
      {id:"1-08",q:"¬øQui√©n perdon√≥ a sus hermanos?",opts:["Jos√©","Jacob","Esa√∫","Benjam√≠n"],ans:0,hint:"En Egipto.",ref:"G√©nesis 45"},
      {id:"1-09",q:"¬øQui√©n traicion√≥ a Jes√∫s?",opts:["Judas","Pedro","Tom√°s","Andr√©s"],ans:0,hint:"Lo bes√≥.",ref:"Mateo 26"},
      {id:"1-10",q:"¬øQui√©n neg√≥ a Jes√∫s tres veces?",opts:["Pedro","Juan","Santiago","Mateo"],ans:0,hint:"Antes del gallo.",ref:"Lucas 22"}
    ]
  }
];

/* ==========================================
   ESTADO
   ========================================== */
let levelIdx=0, qIdx=0, correct=0, questions=[], playerName="";

/* ==========================================
   FLUJO
   ========================================== */
$("#startBtn").onclick=()=>{
  playerName=$("#playerName").value.trim()||"Amigo";
  localStorage.setItem("bbq_name",playerName);
  startLevel(0);
};
$("#levelsBtnW").onclick=$("#levelsBtnR").onclick=()=>{renderLevels();show("#levels");};
$("#backWelcome").onclick=()=>show("#welcome");
$(".ipuc").forEach(b=>b.onclick=()=>window.open("https://www.ipucduitamasancarlos.com.co/p/seccion-kids.html","_self"));
$("#retryBtn").onclick=()=>startLevel(levelIdx);

function startLevel(idx){
  levelIdx=idx;
  const lvl=levels[idx];
  questions=[...lvl.questions].sort(()=>Math.random()-.5);
  qIdx=0; correct=0;
  $("#levelTag").textContent=lvl.title;
  $("#score").textContent="Aciertos: 0";
  show("#game");
  renderQuestion();
}

function renderQuestion(){
  const q=questions[qIdx];
  $("#counter").textContent=`Pregunta ${qIdx+1}/10`;
  $("#questionText").textContent=q.q;
  $("#motivMsg").textContent="";
  $("#hintBox").style.display="none";
  $("#nextBtn").disabled=true;
  $("#progressBar").style.width=`${(qIdx)/10*100}%`;

  const box=$("#options"); box.innerHTML="";
  const opts=[...q.opts].sort(()=>Math.random()-.5);
  opts.forEach(opt=>{
    const btn=document.createElement("button");
    btn.textContent=opt;
    btn.onclick=()=>check(btn,opt,q);
    box.appendChild(btn);
  });
}

function check(btn,opt,q){
  const right=opt===q.opts[q.ans];
  playSound(right?"ok":"fail");
  if(right){
    btn.classList.add("correct");
    correct++;
    $("#score").textContent=`Aciertos: ${correct}`;
    $("#motivMsg").textContent=goodMsgs[Math.floor(Math.random()*goodMsgs.length)];
    launchConfeti();
    // deshabilitar todos
    [...$("#options").children].forEach(b=>b.onclick=null);
    $("#nextBtn").disabled=false;
  }else{
    btn.classList.add("wrong");
    $("#motivMsg").textContent=badMsgs[Math.floor(Math.random()*badMsgs.length)];
    // permite seguir tocando para encontrar la correcta
    btn.disabled=true;
    // cuando toque la correcta pasamos autom√°ticamente
    [...$("#options").children].forEach(b=>{
      if(b.textContent===q.opts[q.ans]){
        b.onclick=()=>{
          b.classList.add("correct");
          correct++;
          $("#score").textContent=`Aciertos: ${correct}`;
          $("#motivMsg").textContent=goodMsgs[Math.floor(Math.random()*goodMsgs.length)];
          launchConfeti();
          [...$("#options").children].forEach(x=>x.onclick=null);
          $("#nextBtn").disabled=false;
        };
      }
    });
  }
}

$("#hintBtn").onclick=()=>{
  const q=questions[qIdx];
  $("#hintBox").textContent=`${q.hint} (Lee: ${q.ref})`;
  $("#hintBox").style.display="block";
};
$("#nextBtn").onclick=()=>{
  if(qIdx<9){qIdx++;renderQuestion();}else{showResult();}
};

function showResult(){
  $("#progressBar").style.width="100%";
  show("#result");
  $("#resName").textContent=playerName;
  $("#resCorrect").textContent=correct;
  const stars=Math.floor(correct/4);
  $("#stars").innerHTML="‚≠ê".repeat(stars)+(stars<3?"üåü".repeat(3-stars):"");
  playSound("win");
  localStorage.setItem("bbq_level",Math.max(levelIdx+(stars?1:0), Number(localStorage.getItem("bbq_level")||0)));
}

function renderLevels(){
  const grid=$("#levelsGrid");
  grid.innerHTML="";
  // por ahora solo nivel 1
  const btn=document.createElement("button");
  btn.textContent="Nivel 1";
  btn.onclick=()=>startLevel(0);
  grid.appendChild(btn);
}

function launchConfeti(){
  for(let i=0;i<30;i++){
    const c=document.createElement("div");
    c.className="confeti";
    c.style.left=Math.random()*100+"%";
    c.style.background=["#ff9f1c","#2ecc71","#3498db","#e74c3c"][Math.floor(Math.random()*4)];
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),2000);
  }
}

/* ==========================================
   IPUC LINKS
   ========================================== */
document.querySelectorAll("#ipucBtnW,#ipucBtnL,#ipucBtnR").forEach(b=>b.onclick=()=>window.open("https://www.ipucduitamasancarlos.com.co/p/seccion-kids.html","_self"));

/* ==========================================
   INICIO
   ========================================== */
window.onload=()=>{
  const n=localStorage.getItem("bbq_name");
  if(n)$("#playerName").value=n;
};
</script>
</body>
</html>
